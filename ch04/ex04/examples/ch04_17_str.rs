fn main() {
    let s1 = "abc1";   // &'static stråž‹
    let s2 = "abc2";
    assert!(s1 < s2);
    assert!(s1 != s2);

    let s3 = "æ–‡å­—åˆ—ã‚’è¤‡æ•°è¡Œã«æ¸¡ã£ã¦æ›¸ãã¨
    æ”¹è¡Œã‚„ã‚¹ãƒšãƒ¼ã‚¹ãŒå…¥ã‚‹";
    let s4 = "è¡Œæœ«ã«ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚’ä»˜ã‘ã‚‹ã¨\
            æ”¹è¡Œãªã©ãŒå…¥ã‚‰ãªã„";

    assert_eq!(s3, "æ–‡å­—åˆ—ã‚’è¤‡æ•°è¡Œã«æ¸¡ã£ã¦æ›¸ãã¨\n    æ”¹è¡Œã‚„ã‚¹ãƒšãƒ¼ã‚¹ãŒå…¥ã‚‹");
    assert_eq!(s4, "è¡Œæœ«ã«ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚’ä»˜ã‘ã‚‹ã¨æ”¹è¡Œãªã©ãŒå…¥ã‚‰ãªã„");

    let s5 = "æ–‡å­—åˆ—ã«\"ã¨\\ã‚’å«ã‚ã‚‹";  // ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã§ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—
    let s6 = r#"æ–‡å­—åˆ—ã«"ã¨\ã‚’å«ã‚ã‚‹"#; // rawæ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã€‚æ­£è¦è¡¨ç¾ãªã©ã«ä¾¿åˆ©
    assert_eq!(s5, s6);

    let s7 = r###"ã“ã®ã‚ˆã†ã«#ã®æ•°ã‚’å¢—ã‚„ã™ã¨"##"ãŒã‚ã£ã¦ã‚‚å¤§ä¸ˆå¤«"###;
    assert_eq!(s7, "ã“ã®ã‚ˆã†ã«#ã®æ•°ã‚’å¢—ã‚„ã™ã¨\"##\"ãŒã‚ã£ã¦ã‚‚å¤§ä¸ˆå¤«");

    #[allow(unused_variables)]
    let s8 = "ã‚‚ã¡ã‚ã‚“çµµæ–‡å­—\u{1f600}ã‚‚ä½¿ãˆã‚‹"; // ã‚‚ã¡ã‚ã‚“çµµæ–‡å­—ðŸ˜€ã‚‚ä½¿ãˆã‚‹

    let fruits = "ã‚ã‹ã‚Šã‚“ã”, ã‚ãŠã‚Šã‚“ã”\nãƒ©ã‚ºãƒ™ãƒªãƒ¼, ãƒ–ãƒ©ãƒƒã‚¯ãƒ™ãƒªãƒ¼";

    // lines()ãƒ¡ã‚½ãƒƒãƒ‰ã¯æ”¹è¡Œã‚³ãƒ¼ãƒ‰ï¼ˆ\nï¼‰ã‚’å«ã‚€æ–‡å­—åˆ—ã‹ã‚‰1è¡Œãšã¤
    // å–ã‚Šå‡ºã›ã‚‹ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã‚’ä½œã‚‹
    let mut lines = fruits.lines();
    // ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã®next()ãƒ¡ã‚½ãƒƒãƒ‰ã§æ¬¡ã®è¡Œã‚’å¾—ã‚‹
    let apple_line = lines.next();
    assert_eq!(apple_line,   Some("ã‚ã‹ã‚Šã‚“ã”, ã‚ãŠã‚Šã‚“ã”"));
    assert_eq!(lines.next(), Some("ãƒ©ã‚ºãƒ™ãƒªãƒ¼, ãƒ–ãƒ©ãƒƒã‚¯ãƒ™ãƒªãƒ¼"));
    // æ¬¡ã®è¡ŒãŒãªã„ãªã‚‰NoneãŒè¿”ã‚‹ã€‚
    assert_eq!(lines.next(), None);

    // ã‚Šã‚“ã”ã®è¡Œï¼ˆSome(..)ï¼‰ã®ä¸­èº«ã‚’å–ã‚Šå‡ºã™
    if let Some(apples) = apple_line {
        // ã€Œã‚ã‹ã€ã§å§‹ã¾ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
        assert!(apples.starts_with("ã‚ã‹"));
        // ã€Œã‚Šã‚“ã”ã€ã®æ–‡å­—ã‚’å«ã‚€ã‹ãƒã‚§ãƒƒã‚¯
        assert!(apples.contains("ã‚Šã‚“ã”"));
        // ã€Œã‚ãŠã€ãŒæœ€åˆã«å‡ºç¾ã™ã‚‹ä½ç½®ï¼ˆUTF-8è¡¨ç¾ã§ä½•ãƒã‚¤ãƒˆç›®ï¼‰ã‚’å¾—ã‚‹
        assert_eq!(apples.find("ã‚ãŠ"), Some(17)); // 0å§‹ã¾ã‚Šãªã®ã§18ãƒã‚¤ãƒˆç›®

        // æ–‡å­—åˆ—ã‚’ã‚«ãƒ³ãƒžï¼ˆ,ï¼‰ã§åˆ†å‰²ã™ã‚‹ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã‚’ä½œã‚‹
        let mut apple_iter = apples.split(",");
        assert_eq!(apple_iter.next(), Some("ã‚ã‹ã‚Šã‚“ã”"));

        let green = apple_iter.next();
        // å·¦å´ã«ä½™ç™½ãŒã‚ã‚‹ã€‚
        assert_eq!(green, Some(" ã‚ãŠã‚Šã‚“ã”"));
        // Some(..)ã®å†…å®¹ã«strã®trim()ãƒ¡ã‚½ãƒƒãƒ‰ã‚’é©ç”¨ã—ã¦ä½™ç™½ã‚’å–ã‚Šé™¤ã
        assert_eq!(green.map(str::trim), Some("ã‚ãŠã‚Šã‚“ã”"));

        assert_eq!(apple_iter.next(), None);
    } else {
        unreachable!();  // ã‚‚ã—ã“ã“ã«åˆ°é”ã—ãŸã‚‰ãƒ‘ãƒ‹ãƒƒã‚¯ã§å¼·åˆ¶çµ‚äº†ã™ã‚‹
    }

    // s1ã‹ã‚‰s4ã¯ã©ã‚Œã‚‚ç”»é¢ä¸Šã§ã¯1æ–‡å­—ã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã‚‹
                    // UTF-8è¡¨ç¾
    let s1 = "a";   // 61
    let s2 = "ã‚";  // E3 81 82
    let s3 = "ðŸ˜€";  // F0 9F 98 80
    let s4 = "ðŸ‡¯ðŸ‡µ";  // F0 9F 87 AF F0 9F 87 B5

    // len()ãƒ¡ã‚½ãƒƒãƒ‰ã¯UTF-8ã®ãƒã‚¤ãƒˆæ•°ã‚’è¿”ã™
    assert_eq!(s1.len(), 1);
    assert_eq!(s2.len(), 3);
    assert_eq!(s3.len(), 4);
    assert_eq!(s4.len(), 8);

    let s = "abcã‚ã„ã†";
    assert_eq!(s.get(0..1), Some("a"));
    assert_eq!(s.get(3..6), Some("ã‚"));
    assert_eq!(s.get(3..4), None);  // UTF-8ã¨ã—ã¦è§£é‡ˆã§ããªã„å ´åˆ

    let s = "ã‹ã‹\u{3099}ã";  // \u{3099}ã¯æ¿ç‚¹æ–‡å­—
    println!("{}", s);        // ã‹ãŒã

    let mut iter = s.chars();
    assert_eq!(iter.next(), Some('ã‹'));
    assert_eq!(iter.next(), Some('ã‹'));
    assert_eq!(iter.next(), Some('\u{3099}'));
    assert_eq!(iter.next(), Some('ã'));
    assert_eq!(iter.next(), None);

    let utf8: [u8; 4] = [0x61, 0xe3, 0x81, 0x82];
    assert_eq!(std::str::from_utf8(&utf8), Ok("aã‚"));

    let bad_utf8: [u8; 2] = [0x81, 0x33];  // ã§ãŸã‚‰ã‚ãªãƒã‚¤ãƒˆåˆ—
    let result2 = std::str::from_utf8(&bad_utf8);
    assert!(result2.is_err());
    println!("{:?}", result2);
    // â†’ "Err(Utf8Error { valid_up_to: 0, error_len: Some(1) })"

    // æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ï¼ˆ&'static strï¼‰ã‹ã‚‰&mut strã¯ç›´æŽ¥ã¯å¾—ã‚‰ã‚Œãªã„
    // ã¾ãšæ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã‚’Stringã¸å¤‰æ›ã—ã€ãã“ã‹ã‚‰&mut strã‚’å–ã‚Šå‡ºã™
    let mut s1 = "abcã‚ã„ã†".to_string();  // Stringåž‹

    // &mut strã‚’å¾—ã‚‹ã€‚ã“ã‚Œã¯StringãŒæŒã¤UTF-8ãƒã‚¤ãƒˆåˆ—ã‚’æŒ‡ã™å¯å¤‰ã‚¹ãƒ©ã‚¤ã‚¹
    let s2 = s1.as_mut_str();         // &mut stråž‹

    // è‹±å°æ–‡å­—ã‚’å¤§æ–‡å­—ã«å¤‰æ›´
    s2.make_ascii_uppercase();
    assert_eq!(s2, "ABCã‚ã„ã†");

    // &mut strã®UTF-8ãƒã‚¤ãƒˆåˆ—ã‚’ç›´æŽ¥æ“ä½œã—ã¦"ã‚"ï¼ˆ3ãƒã‚¤ãƒˆï¼‰ã‚’"*a*"ã«å¤‰æ›´ã™ã‚‹
    let b = unsafe { s2.as_bytes_mut() };
    b[3] = b'*';
    b[4] = b'a';
    b[5] = b'*';

    // å¤§å…ƒã®StringãŒå¤‰æ›´ã•ã‚Œã¦ã„ã‚‹
    assert_eq!(s1, "ABC*a*ã„ã†");
}
